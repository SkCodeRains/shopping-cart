import{a as mt,b as E,d as k,h as ht}from"./chunk-NUDTNQBT.js";import{Da as D,Fa as et,I as W,J as q,M as X,Ma as ot,Na as it,Oa as nt,Pa as rt,Q as G,Qa as ct,R as C,Ra as w,Sa as c,Ta as l,Ua as T,W as h,X as g,Ya as v,_a as p,a as _,ab as f,b as x,bb as lt,ca as b,cb as st,db as at,eb as m,fa as Z,fb as dt,gb as y,ia as $,ib as ut,l as L,ob as K,p as I,pa as J,pb as pt,qb as ft,r as Y,ra as s,u as Q,ub as M,v as B,va as N,wa as tt,za as V}from"./chunk-5VBEFWA7.js";var H=class e{constructor(t){this.http=t}reloadTrigger=b(0);products=b([]);reload(){this.reloadTrigger.update(t=>t+1)}getProductById(t){return this.products().find(o=>o.id===t)}getRelatedProducts(t){return this.products().filter(o=>o.id!==t.id&&(o.category===t.category||o.brand===t.brand||o.tags?.some(i=>t.tags?.includes(i))))}updateStockAfterCheckout(t){let o=this.products().map(i=>{let n=t.find(r=>r.product.id===i.id);return n?x(_({},i),{stock:Math.max(0,i.stock-n.quantity)}):i});this.products.set(o)}static \u0275fac=function(o){return new(o||e)(G(k))};static \u0275prov=X({token:e,factory:e.\u0275fac,providedIn:"root"})};function yt(e,t,o,i){let n=window&&!!window.document&&window.document.documentElement,r=n&&t?window:o;if(e&&(r=e&&n&&typeof e=="string"?_t(e,o.nativeElement,i):e,!r))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return r}function _t(e,t,o){return(o?window.document:t).querySelector(e)}function A(e){return e&&!e.firstChange}function xt(){return typeof window<"u"}var Dt={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},Et={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},U=class{constructor(t=!0){this.vertical=t,this.propsMap=t?Dt:Et}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}};function kt(e,t,o){return!!(e&&t||!o&&t)}function Mt({windowElement:e,axis:t}){return Ht({axis:t,isWindow:Ot(e)},e)}function Ht(e,t){let o=e.isWindow||t&&!t.nativeElement?t:t.nativeElement;return x(_({},e),{container:o})}function Ot(e){return["Window","global"].some(o=>Object.prototype.toString.call(e).includes(o))}function z(e,t){return e?t.document.documentElement:null}function gt(e,t){let o=Nt(t);return t.isWindow?It(o,e,t):Wt(o,e,t)}function It(e,t,o){let{axis:i,container:n,isWindow:r}=o,{offsetHeightKey:a,clientHeightKey:u}=wt(i),S=e+Ct(z(r,n),i,r),d=St(t.nativeElement,r,a,u),P=Vt(t.nativeElement,i,r)+d;return{height:e,scrolled:S,totalToScroll:P,isWindow:r}}function Wt(e,t,o){let{axis:i,container:n}=o,r=n[i.scrollTopKey()],a=n[i.scrollHeightKey()];return{height:e,scrolled:r,totalToScroll:a,isWindow:!1}}function wt(e){return{offsetHeightKey:e.offsetHeightKey(),clientHeightKey:e.clientHeightKey()}}function Nt({container:e,isWindow:t,axis:o}){let{offsetHeightKey:i,clientHeightKey:n}=wt(o);return St(e,t,i,n)}function St(e,t,o,i){if(isNaN(e[o])){let n=z(t,e);return n?n[i]:0}else return e[o]}function Vt(e,t,o){let i=t.topKey();if(e.getBoundingClientRect)return e.getBoundingClientRect()[i]+Ct(e,t,o)}function Ct(e,t,o){let i=t.pageYOffsetKey(),n=t.scrollTopKey(),r=t.offsetTopKey();return isNaN(window.pageYOffset)?z(o,e)[n]:e.ownerDocument?e.ownerDocument.defaultView[i]:e[r]}function Kt(e,t={down:0,up:0},o){let i,n;if(e.totalToScroll<=0)return!1;let r=e.isWindow?e.scrolled:e.height+e.scrolled;if(o)i=(e.totalToScroll-r)/e.totalToScroll,n=(t?.down?t.down:0)/10;else{let u=e.scrolled+(e.totalToScroll-r);i=e.scrolled/u,n=(t?.up?t.up:0)/10}return i<=n}function Ft(e,t){return e<t.scrolled}function At(e,t,o){let i=Ft(e,t);return{fire:Kt(t,o,i),scrollDown:i}}var j=class{constructor(t){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},Object.assign(this,t)}updateScrollPosition(t){return this.lastScrollPosition=t}updateTotalToScroll(t){this.lastTotalToScroll!==t&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=t)}updateScroll(t,o){this.updateScrollPosition(t),this.updateTotalToScroll(o)}updateTriggeredFlag(t,o){o?this.triggered.down=t:this.triggered.up=t}isTriggeredScroll(t,o){return o?this.triggered.down===t:this.triggered.up===t}};function Ut(e){let{scrollContainer:t,scrollWindow:o,element:i,fromRoot:n}=e,r=Mt({axis:new U(!e.horizontal),windowElement:yt(t,o,i,n)}),a=new j({totalToScroll:gt(i,r).totalToScroll}),u={container:r.container,throttle:e.throttle},S={up:e.upDistance,down:e.downDistance};return jt(u).pipe(Y(()=>L(gt(i,r))),I(d=>Rt(a.lastScrollPosition,d,S)),W(({stats:d})=>a.updateScroll(d.scrolled,d.totalToScroll)),B(({fire:d,scrollDown:P,stats:{totalToScroll:Tt}})=>kt(e.alwaysCallback,d,a.isTriggeredScroll(Tt,P))),W(({scrollDown:d,stats:{totalToScroll:P}})=>{a.updateTriggeredFlag(P,d)}),I(zt))}function jt(e){let t=Q(e.container,"scroll");return e.throttle&&(t=t.pipe(q(e.throttle,void 0,{leading:!0,trailing:!0}))),t}function Rt(e,t,o){let{scrollDown:i,fire:n}=At(e,t,o);return{scrollDown:i,fire:n,stats:t}}var R={DOWN:"[NGX_ISE] DOWN",UP:"[NGX_ISE] UP"};function zt(e){let{scrollDown:t,stats:{scrolled:o}}=e;return{type:t?R.DOWN:R.UP,payload:{currentScrollPosition:o}}}var vt=(()=>{let t=class t{constructor(i,n){this.element=i,this.zone=n,this.scrolled=new N,this.scrolledUp=new N,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:i,infiniteScrollDisabled:n,infiniteScrollDistance:r}){let a=A(i),u=A(n),S=A(r),d=!u&&!this.infiniteScrollDisabled||u&&!n.currentValue||S;(a||u||S)&&(this.destroyScroller(),d&&this.setup())}ngOnDestroy(){this.destroyScroller()}setup(){xt()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=Ut({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(i=>this.handleOnScroll(i))})}handleOnScroll({type:i,payload:n}){let r=i===R.DOWN?this.scrolled:this.scrolledUp;Lt(r)&&this.zone.run(()=>r.emit(n))}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}};t.\u0275fac=function(n){return new(n||t)(V($),V(tt))},t.\u0275dir=et({type:t,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[Z]});let e=t;return e})();function Lt(e){return e.observed??e.observers.length>0}var Qt=(e,t)=>({"btn-outline-primary":e,"btn-secondary disabled":t});function Bt(e,t){if(e&1){let o=v();c(0,"button",14),p("click",function(n){h(o);let r=f();return g(r.add(r.product(),n))}),T(1,"i",15),m(2," Add to Cart "),l()}if(e&2){let o=f();w("ngClass",ut(1,Qt,o.product().stock>0,o.product().stock<=0))}}function qt(e,t){if(e&1){let o=v();c(0,"div",13)(1,"button",16),p("click",function(){h(o);let n=f();return g(n.cartService.decreaseQuantity(n.product().id))}),T(2,"i",17),l(),c(3,"span",18),m(4),l(),c(5,"button",19),p("click",function(){h(o);let n=f();return g(n.cartService.increaseQuantity(n.product().id))}),T(6,"i",20),l()()}if(e&2){let o=f();s(),w("disabled",o.cartService.getQuantity(o.product().id)<=1),s(3),y(" ",o.cartService.getQuantity(o.product().id)," "),s(),w("disabled",o.cartService.getQuantity(o.product().id)>=o.product().stock)}}var O=class e{product=pt.required();addToCart=K();openProduct=K();cartService=C(M);add(t,o){o.preventDefault(),this.addToCart.emit(t)}open(t){this.openProduct.emit(t)}static \u0275fac=function(o){return new(o||e)};static \u0275cmp=D({type:e,selectors:[["app-product"]],inputs:{product:[1,"product"]},outputs:{addToCart:"addToCart",openProduct:"openProduct"},decls:18,vars:13,consts:[[1,"p-2","position-relative","overflow-hidden"],[1,"card","product-card","shadow-sm","overflow-hidden","pt-2","btn","btn-warning","shadow","h-100","w-100"],[1,"w-100","center",3,"click"],[1,"card-img-top",3,"src","alt"],[1,"card-body","d-flex","flex-column","overflow-y-auto","position-absolute","bottom-0","w-100","start-0"],[1,"card-title","text-truncate",3,"click"],[1,"card-text","small","text-muted","flex-grow-1",3,"click"],[1,"mt-auto"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"mb-0","text-primary","fw-bold"],[1,"badge"],[1,"mt-2"],[1,"btn","btn-sm","w-100",3,"ngClass"],[1,"d-flex","justify-content-between","align-items-center","gap-2"],[1,"btn","btn-sm","w-100",3,"click","ngClass"],[1,"bi","bi-cart-plus","me-1"],[1,"btn","btn-sm","btn-outline-secondary","flex-grow-1",3,"click","disabled"],[1,"bi","bi-dash"],[1,"fw-semibold"],[1,"btn","btn-sm","btn-outline-primary","flex-grow-1",3,"click","disabled"],[1,"bi","bi-plus"]],template:function(o,i){o&1&&(c(0,"div",0)(1,"div",1)(2,"div",2),p("click",function(){return i.open(i.product())}),T(3,"img",3),l(),c(4,"div",4)(5,"h5",5),p("click",function(){return i.open(i.product())}),m(6),l(),c(7,"p",6),p("click",function(){return i.open(i.product())}),m(8),l(),c(9,"div",7)(10,"div",8)(11,"h6",9),m(12),l(),c(13,"span",10),m(14),l()(),c(15,"div",11),ot(16,Bt,3,4,"button",12)(17,qt,7,3,"div",13),l()()()()()),o&2&&(s(3),w("src",i.product().imageUrl,J)("alt",i.product().title),s(3),dt(i.product().title),s(2),y(" ",i.product().description," "),s(4),y("\u20B9",i.product().price),s(),at("bg-success",i.product().stock>5)("bg-warning",i.product().stock<=5&&i.product().stock>0)("bg-danger",i.product().stock<=0),s(),y(" ",i.product().stock>0?i.product().stock>5?"In Stock":"Low Stock":"Out of Stock"," "),s(2),it(i.cartService.isInCart(i.product().id)?17:16))},dependencies:[E,mt],styles:["[_nghost-%COMP%]   .card[_ngcontent-%COMP%]{width:450px!important;height:350px!important;border-radius:.75rem;transition:transform .2s ease,box-shadow .2s ease}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 6px 20px #0000001a}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:10rem;width:70%;align-items:center;object-fit:cover;border-top-left-radius:.75rem;border-top-right-radius:.75rem}[_nghost-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]})};var Pt={API_PATH:"/shopping-cart/data/"};var Xt=["scrollContainer"];function Gt(e,t){if(e&1){let o=v();c(0,"app-product",5),p("openProduct",function(n){h(o);let r=f();return g(r.openProduct(n))})("addToCart",function(n){h(o);let r=f();return g(r.addToCart(n))}),l()}if(e&2){let o=t.$implicit;w("product",o)}}var bt=class e{http=C(k);productService=C(H);cartService=C(M);router=C(ht);scrollContainer=ft("scrollContainer");PATH=Pt.API_PATH;data=b([]);size=0;ngAfterViewInit(){this.getProductsData()}onScroll(){if(this.data().length<this.productService.products().length){let o=this.productService.products().slice(0,this.size+=5);this.data.set(o),setTimeout(()=>{this.isScrollView()&&this.onScroll()},1e3)}}isScrollView(){return this.scrollContainer()?.nativeElement.scrollHeight<=this.scrollContainer()?.nativeElement.clientHeight}getProductsData(){this.productService.products().length==0?this.http.get(this.PATH+"products.json").subscribe({next:t=>{this.productService.products.set(t),this.onScroll()},error:t=>console.error(t)}):this.onScroll()}addToCart(t){this.cartService.addToCart(t)}openProduct(t){this.router.navigate(["product",t.id],{state:{product:t}})}static \u0275fac=function(o){return new(o||e)};static \u0275cmp=D({type:e,selectors:[["app-product-list-component"]],viewQuery:function(o,i){o&1&&lt(i.scrollContainer,Xt,5),o&2&&st()},decls:8,vars:3,consts:[["scrollContainer",""],[1,"product-list","center","p-4"],["infiniteScroll","",1,"search-results","h-100","products","center","w-100","overflow-y-auto","row-cols-lg-2","flex-wrap",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle","scrollWindow"],[1,"mt-4","w-100"],[2,"max-width","460px",3,"product"],[2,"max-width","460px",3,"openProduct","addToCart","product"]],template:function(o,i){if(o&1){let n=v();c(0,"section",1)(1,"div",2,0),p("scrolled",function(){return h(n),g(i.onScroll())}),c(3,"div",3)(4,"h3"),m(5,"Products You\u2019ll Absolutely Love "),l()(),rt(6,Gt,1,1,"app-product",4,nt),l()()}o&2&&(s(),w("infiniteScrollDistance",1)("infiniteScrollThrottle",50)("scrollWindow",!1),s(5),ct(i.data()))},dependencies:[vt,E,O],styles:["[_nghost-%COMP%]   .search-results[_ngcontent-%COMP%]{max-width:1000px}[_nghost-%COMP%]   .product-list[_ngcontent-%COMP%]{height:calc(100% - 5rem)}"]})};export{vt as a,O as b,bt as c};
